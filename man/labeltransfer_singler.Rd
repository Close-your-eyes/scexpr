% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/labeltransfer_singler.R
\name{labeltransfer_singler}
\alias{labeltransfer_singler}
\title{Transfer cluster labels, i.e. celltype classification between objects}
\usage{
labeltransfer_singler(
  test_obj,
  ref_obj,
  ref_labels,
  test_clusters = NULL,
  name_prefix = NULL,
  singler_args = list(de.method = "wilcox", fine.tune = T, aggr.ref = F),
  get_layer_args = list(layer = "data", assay = "RNA")
)
}
\arguments{
\item{test_obj}{Seurat object or gene x cell matrix (sparse/dense) to which
labels should be transferred}

\item{ref_obj}{Seurat object, SummarizedExperiment or gene x cell matrix}

\item{ref_labels}{when ref_obj is Seurat: meta.data column, when
SummarizedExperiment: name of element in ref_obj_colData_listData, when
matrix: label vector of length ncol(ref_obj)}

\item{test_clusters}{NULL to run SingleR on single cells; to run on clusters,
when test_obj is Seurat: meta.data column, when matrix: vector of cluster
idents of length ncol(test_obj)}

\item{name_prefix}{prefix to all returned columns}

\item{singler_args}{arguments to SingleR::SingleR}

\item{get_layer_args}{arguments to scexpr::get_layer (applies when test_obj
or ref_obj is Seurat)}
}
\value{
list of data frame, matrix, named vector, score plot of SingleR
results
}
\description{
How SingleR computes. Marker selection: For each label, SingleR identifies genes
that distinguish it from the others (de.method argument). Scoring: For a given
query cell, it computes correlation between that cell’s expression profile and
the reference expression profile restricted to those marker genes. Best
label: The label with the highest score is assigned. Fine-tuning: It optionally
refines the set of genes for the top labels and recomputes scores → final label.
How to interpret. Higher score = higher similarity between query cell and the
reference profile. Relative differences matter more than absolute values (e.g.
0.6 vs 0.3 is decisive; 0.61 vs 0.59 is ambiguous). SingleR also reports:
score.max → the best score per cell. delta → the difference between top and
runner-up (margin of confidence). pruned.labels → removes labels when the margin
is too small (set to NA = “ambiguous”). Not strict probabilities. Scores are not
calibrated probabilities (they don’t sum to 1). They’re correlations, so you can
think of them as “confidence-like.” If you want probability-like values, you can
normalize across labels per cell (e.g. softmax), but this is an approximation.
}
\details{
fine.tune may cause that the assigned label is not the top score.
for single cell data use de.method = "wilcox", for bulk as ref "classic".
}
\examples{
\dontrun{
out <- labeltransfer_singler(test_obj = seu_test,
                             ref_obj = seu_ref,
                             ref_labels = seu_ref@meta.data$celltypes,
                             test_clusters = seu_test@meta.data$SCT_snn_res.0.8,
                             name_prefix = "enghard")
}
}
